const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReportPreview-CDJK1Wko.js","assets/pdf-BllNUW5F.js","assets/index-CY_W9l9r.js","assets/vue-CbfYRXie.js","assets/network-QpDy7ETe.js","assets/index-DK5L7Jtf.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/ModalAlert-DBpkgysQ.js","assets/ReportPreview-thBETWz2.css"])))=>i.map(i=>d[i]);
import{_ as A}from"./pdf-BllNUW5F.js";import{y as L,r as d,c as U,o as E,a as n,b as e,k as M,e as x,s as i,v as b,E as w,F as h,f as D,t as l,n as B,z as Y,D as j,u as z,j as r}from"./vue-CbfYRXie.js";import{_ as q,a as H}from"./report-R8wnBXMV.js";import{a as k}from"./network-QpDy7ETe.js";import{u as I}from"./index-CY_W9l9r.js";const K={class:"p-6 font-nanum"},O={class:"p-4 bg-gray-50 rounded-lg shadow-inner mb-6 flex flex-wrap gap-6 items-end"},G={class:"flex flex-col w-40"},J=["readonly"],Q={class:"flex flex-col w-36"},W={class:"flex flex-col w-32"},X={class:"flex flex-col w-40"},Z={class:"flex flex-col w-40"},tt={class:"flex items-end"},et={class:"bg-white rounded-lg shadow overflow-hidden"},ot={class:"w-full border-collapse text-sm"},st={class:"border p-3"},at={class:"border p-3"},lt={class:"border p-3"},rt={class:"border p-3"},nt={class:"border p-3"},dt={class:"border p-3 text-right"},it={class:"border p-3"},ut={class:"border p-3 flex justify-center space-x-3"},pt=["onClick"],mt=["onClick"],ct={key:0},vt={class:"flex justify-center mt-6 space-x-2"},bt=["onClick"],ht={__name:"ApprovalList",setup(ft){const N=j(()=>A(()=>import("./ReportPreview-CDJK1Wko.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),S=z(),{user:u}=L(I()),p=d([]),f=d(1),g=d(1),m=d(null),y=new Date,$=y.getFullYear(),C=new Date($,0,1),_=s=>{const t=s.getFullYear(),o=String(s.getMonth()+1).padStart(2,"0"),c=String(s.getDate()).padStart(2,"0");return`${t}-${o}-${c}`},a=d({deptName:"",documentType:"",startDate:_(C),endDate:_(y),status:""}),F=U(()=>{var s;return(s=u.value)!=null&&s.roles?u.value.roles.some(t=>t.role_name==="재정부"||t.role_name==="관리자"):!1});E(()=>{var s;(s=u.value)!=null&&s.deptName&&(a.value.deptName=u.value.deptName,v(1))});const v=async(s=1)=>{f.value=s;try{const t=await k.post("/api/approvalList",{...a.value,page:s,pageSize:10});p.value=t.data.rows,g.value=t.data.totalPages}catch{p.value=[]}},R=s=>{if(!s)return"";const t=new Date(s);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},V=s=>{if(s==null)return"";const t=Number(s);return isNaN(t)?s:Number.isInteger(t)?t.toLocaleString("ko-KR"):t.toLocaleString("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:2})},T=async s=>{try{const t=await k.get(`/api/approval/detail/${s}`),o={id:t.data.id,documentType:t.data.document_type,deptName:t.data.dept_name,author:t.data.author,date:t.data.request_date,totalAmount:t.data.total_amount,comment:t.data.comment,aliasName:t.data.aliasName,items:t.data.items||[],attachedFiles:t.data.attachedFiles||[],approvalHistory:t.data.approvalHistory||[]};m.value=o}catch{}},P=s=>{S.push({name:"ReportForm",params:{id:s}})};return(s,t)=>(r(),n("div",K,[t[18]||(t[18]=e("h2",{class:"text-2xl font-bold text-purple-700 mb-6"},"📑 청구목록 조회",-1)),e("div",O,[e("div",G,[t[7]||(t[7]=e("label",{class:"font-semibold text-gray-800 mb-1"},"부서명",-1)),i(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>a.value.deptName=o),placeholder:"부서명 입력",class:"border rounded-lg p-2 w-full shadow-sm",readonly:!F.value},null,8,J),[[b,a.value.deptName]])]),e("div",Q,[t[9]||(t[9]=e("label",{class:"font-semibold text-gray-800 mb-1"},"문서종류",-1)),i(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.value.documentType=o),class:"border rounded-lg p-2 w-full shadow-sm"},[...t[8]||(t[8]=[e("option",{value:""},"전체",-1),e("option",{value:"청구지출결의서"},"청구지출결의서",-1),e("option",{value:"정산지출결의서"},"정산지출결의서",-1),e("option",{value:"가불지출결의서"},"가불지출결의서",-1)])],512),[[w,a.value.documentType]])]),e("div",W,[t[11]||(t[11]=e("label",{class:"font-semibold text-gray-800 mb-1"},"진행상태",-1)),i(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.status=o),class:"border rounded-lg p-2 w-full shadow-sm"},[...t[10]||(t[10]=[e("option",{value:""},"전체",-1),e("option",{value:"완료"},"완료",-1),e("option",{value:"반려"},"반려",-1),e("option",{value:"진행중"},"진행중",-1)])],512),[[w,a.value.status]])]),e("div",X,[t[12]||(t[12]=e("label",{class:"font-semibold text-gray-800 mb-1"},"청구 시작일자",-1)),i(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=o=>a.value.startDate=o),class:"border rounded-lg p-2 w-full shadow-sm"},null,512),[[b,a.value.startDate]])]),e("div",Z,[t[13]||(t[13]=e("label",{class:"font-semibold text-gray-800 mb-1"},"청구 종료일자",-1)),i(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=o=>a.value.endDate=o),class:"border rounded-lg p-2 w-full shadow-sm"},null,512),[[b,a.value.endDate]])]),e("div",tt,[e("button",{onClick:t[5]||(t[5]=o=>v(1)),class:"px-5 py-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-lg shadow hover:from-purple-600 hover:to-indigo-700 transition"}," 조회 ")])]),e("div",et,[e("table",ot,[t[17]||(t[17]=e("thead",null,[e("tr",{class:"bg-purple-100 text-gray-700"},[e("th",{class:"border p-3"},"문서종류"),e("th",{class:"border p-3"},"부서명"),e("th",{class:"border p-3"},"작성자"),e("th",{class:"border p-3"},"청구요청 별칭"),e("th",{class:"border p-3"},"청구일자"),e("th",{class:"border p-3"},"총액"),e("th",{class:"border p-3"},"진행상태"),e("th",{class:"border p-3"},"상세")])],-1)),e("tbody",null,[(r(!0),n(h,null,D(p.value,o=>(r(),n("tr",{key:o.id,class:"hover:bg-purple-50 transition"},[e("td",st,l(o.document_type),1),e("td",at,l(o.dept_name),1),e("td",lt,l(o.author),1),e("td",rt,l(o.aliasName),1),e("td",nt,l(R(o.request_date)),1),e("td",dt,l(V(o.total_amount)),1),e("td",it,l(o.status),1),e("td",ut,[e("button",{onClick:c=>T(o.id),class:"p-2 rounded-lg hover:bg-green-100 transition",title:"상세보기"},[...t[14]||(t[14]=[e("img",{src:q,alt:"상세보기",class:"w-6 h-6"},null,-1)])],8,pt),e("button",{onClick:c=>P(o.id),class:"p-2 rounded-lg hover:bg-purple-100 transition",title:"보고서작성"},[...t[15]||(t[15]=[e("img",{src:H,alt:"보고서작성",class:"w-6 h-6"},null,-1)])],8,mt)])]))),128)),p.value.length===0?(r(),n("tr",ct,[...t[16]||(t[16]=[e("td",{colspan:"10",class:"text-center p-6 text-gray-500"},"데이터가 없습니다.",-1)])])):x("",!0)])])]),e("div",vt,[(r(!0),n(h,null,D(g.value,o=>(r(),n("button",{key:o,onClick:c=>v(o),class:B(["px-4 py-1 border rounded-lg transition",f.value===o?"bg-purple-600 text-white":"bg-white hover:bg-gray-100"])},l(o),11,bt))),128))]),m.value?(r(),M(Y(N),{key:0,report:m.value,onClose:t[6]||(t[6]=o=>m.value=null)},null,8,["report"])):x("",!0)]))}};export{ht as default};
