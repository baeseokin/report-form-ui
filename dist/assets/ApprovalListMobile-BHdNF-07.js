const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReportPreview-DfF5__ip.js","assets/pdf-BllNUW5F.js","assets/index-C6LadfhI.js","assets/vue-CbfYRXie.js","assets/network-QpDy7ETe.js","assets/index-DK5L7Jtf.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/ModalAlert-DBpkgysQ.js","assets/ReportPreview-thBETWz2.css"])))=>i.map(i=>d[i]);
import{_ as L}from"./pdf-BllNUW5F.js";import{y as M,r as u,o as U,a as r,b as e,k as h,e as k,s as d,v as c,E as _,F as D,f as N,t as l,g as i,n as j,z as B,u as E,j as n}from"./vue-CbfYRXie.js";import{_ as Y,a as z}from"./report-R8wnBXMV.js";import{a as S}from"./network-QpDy7ETe.js";import{u as q}from"./index-C6LadfhI.js";const H={class:"p-4 font-nanum bg-gray-50 min-h-screen"},I={class:"space-y-3 mb-6"},K={class:"space-y-4"},O={class:"flex justify-between items-center mb-2"},G={class:"font-bold text-purple-700"},J={class:"text-sm px-2 py-1 rounded bg-gray-100"},Q={class:"text-gray-700 text-sm"},W={class:"text-gray-700 text-sm"},X={class:"text-gray-700 text-sm"},Z={class:"text-gray-700 text-sm"},tt={class:"text-gray-700 text-sm"},et={class:"flex justify-end space-x-3 mt-3"},ot=["onClick"],st=["onClick"],at={key:0,class:"text-center text-gray-500"},lt={class:"flex justify-center mt-6 space-x-2"},nt=["onClick"],vt={__name:"ApprovalListMobile",setup(rt){const $=defineAsyncComponent(()=>L(()=>import("./ReportPreview-DfF5__ip.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),C=E(),{user:b}=M(q()),p=u([]),y=u(1),f=u(1),m=u(null),x=new Date,F=x.getFullYear(),V=new Date(F,0,1),w=s=>{const t=s.getFullYear(),o=String(s.getMonth()+1).padStart(2,"0"),v=String(s.getDate()).padStart(2,"0");return`${t}-${o}-${v}`},a=u({deptName:"",documentType:"",startDate:w(V),endDate:w(x),status:""});U(()=>{var s;(s=b.value)!=null&&s.deptName&&(a.value.deptName=b.value.deptName,g(1))});const g=async(s=1)=>{y.value=s;try{const t=await S.post("/api/approvalList",{...a.value,page:s,pageSize:10});p.value=t.data.rows,f.value=t.data.totalPages}catch{p.value=[]}},R=s=>{if(!s)return"";const t=new Date(s);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},T=s=>{if(s==null)return"";const t=Number(s);return isNaN(t)?s:Number.isInteger(t)?t.toLocaleString("ko-KR"):t.toLocaleString("ko-KR",{minimumFractionDigits:0,maximumFractionDigits:2})},P=async s=>{try{const t=await S.get(`/api/approval/detail/${s}`),o={id:t.data.id,documentType:t.data.document_type,deptName:t.data.dept_name,author:t.data.author,date:t.data.request_date,totalAmount:t.data.total_amount,comment:t.data.comment,aliasName:t.data.aliasName,items:t.data.items||[],attachedFiles:t.data.attachedFiles||[],approvalHistory:t.data.approvalHistory||[]};m.value=o}catch{}},A=s=>{C.push({name:"ReportForm",params:{id:s}})};return(s,t)=>(n(),r("div",H,[t[20]||(t[20]=e("h2",{class:"text-lg font-bold text-gray-800 mb-4"},"📑 청구목록 조회",-1)),e("div",I,[d(e("input",{type:"hidden","onUpdate:modelValue":t[0]||(t[0]=o=>a.value.deptName=o)},null,512),[[c,a.value.deptName]]),e("div",null,[t[8]||(t[8]=e("label",{class:"font-bold mb-1 block"},"문서종류",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.value.documentType=o),class:"border rounded p-2 w-full"},[...t[7]||(t[7]=[e("option",{value:""},"전체",-1),e("option",{value:"청구지출결의서"},"청구지출결의서",-1),e("option",{value:"정산지출결의서"},"정산지출결의서",-1),e("option",{value:"가불지출결의서"},"가불지출결의서",-1)])],512),[[_,a.value.documentType]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"font-bold mb-1 block"},"진행상태",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.status=o),class:"border rounded p-2 w-full"},[...t[9]||(t[9]=[e("option",{value:""},"전체",-1),e("option",{value:"완료"},"완료",-1),e("option",{value:"반려"},"반려",-1),e("option",{value:"진행중"},"진행중",-1)])],512),[[_,a.value.status]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"font-bold mb-1 block"},"청구 시작일자",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=o=>a.value.startDate=o),class:"border rounded p-2 w-full"},null,512),[[c,a.value.startDate]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"font-bold mb-1 block"},"청구 종료일자",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=o=>a.value.endDate=o),class:"border rounded p-2 w-full"},null,512),[[c,a.value.endDate]])]),e("button",{onClick:t[5]||(t[5]=o=>g(1)),class:"w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700 mt-2"}," 조회 ")]),e("div",K,[(n(!0),r(D,null,N(p.value,o=>(n(),r("div",{key:o.id,class:"bg-white rounded-lg shadow-md p-4 border"},[e("div",O,[e("h3",G,l(o.document_type),1),e("span",J,l(o.status),1)]),e("p",Q,[t[13]||(t[13]=e("strong",null,"부서:",-1)),i(" "+l(o.dept_name),1)]),e("p",W,[t[14]||(t[14]=e("strong",null,"작성자:",-1)),i(" "+l(o.author),1)]),e("p",X,[t[15]||(t[15]=e("strong",null,"별칭:",-1)),i(" "+l(o.aliasName),1)]),e("p",Z,[t[16]||(t[16]=e("strong",null,"일자:",-1)),i(" "+l(R(o.request_date)),1)]),e("p",tt,[t[17]||(t[17]=e("strong",null,"총액:",-1)),i(" "+l(T(o.total_amount)),1)]),e("div",et,[e("button",{onClick:v=>P(o.id),class:"p-2 rounded hover:bg-green-100",title:"상세보기"},[...t[18]||(t[18]=[e("img",{src:Y,alt:"상세보기",class:"w-6 h-6"},null,-1)])],8,ot),e("button",{onClick:v=>A(o.id),class:"p-2 rounded hover:bg-purple-100",title:"보고서작성"},[...t[19]||(t[19]=[e("img",{src:z,alt:"보고서작성",class:"w-6 h-6"},null,-1)])],8,st)])]))),128)),p.value.length===0?(n(),r("p",at," 데이터가 없습니다. ")):k("",!0)]),e("div",lt,[(n(!0),r(D,null,N(f.value,o=>(n(),r("button",{key:o,onClick:v=>g(o),class:j(["px-3 py-1 border rounded",y.value===o?"bg-blue-600 text-white":"bg-white hover:bg-gray-100"])},l(o),11,nt))),128))]),m.value?(n(),h(B($),{key:0,report:m.value,onClose:t[6]||(t[6]=o=>m.value=null)},null,8,["report"])):k("",!0)]))}};export{vt as default};
