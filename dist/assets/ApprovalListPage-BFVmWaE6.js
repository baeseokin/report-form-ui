const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReportPreview-CDJK1Wko.js","assets/pdf-BllNUW5F.js","assets/index-CY_W9l9r.js","assets/vue-CbfYRXie.js","assets/network-QpDy7ETe.js","assets/index-DK5L7Jtf.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/ModalAlert-DBpkgysQ.js","assets/ReportPreview-thBETWz2.css"])))=>i.map(i=>d[i]);
import{_ as S}from"./pdf-BllNUW5F.js";import{r as u,G as C,o as L,a as n,b as e,k as N,e as y,F as h,f as _,s as P,H as R,t as r,n as F,z as T,D as j,j as a}from"./vue-CbfYRXie.js";import{u as I}from"./index-CY_W9l9r.js";import"./network-QpDy7ETe.js";const M={class:"p-6 font-nanum"},O={class:"p-4 bg-gray-50 rounded-lg shadow-inner mb-6 flex flex-wrap gap-6 items-end"},$={class:"flex flex-col"},A={class:"flex space-x-4"},B=["value"],V={class:"text-gray-700"},z={class:"flex items-end"},E={class:"bg-white rounded-lg shadow overflow-hidden"},H={class:"w-full border-collapse text-sm"},U={class:"border p-3"},q={class:"border p-3"},Y={class:"border p-3"},G={class:"border p-3"},J={class:"border p-3 text-right"},K={class:"border p-3 text-center"},Q=["onClick"],W={key:0},X={class:"mt-6 flex justify-center space-x-2"},Z=["onClick"],nt={__name:"ApprovalListPage",setup(tt){var f,x;const w=j(()=>S(()=>import("./ReportPreview-CDJK1Wko.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),m=u([]),d=u(1),g=u(1),p=u(null),v=I(),l=C({months:1,deptName:((f=v.user)==null?void 0:f.deptName)||"",status:"진행중",approverUserId:((x=v.user)==null?void 0:x.userId)||"",startDate:"",endDate:""}),b=()=>{const o=new Date,s=l.months,t=new Date(o.getFullYear(),o.getMonth()-(s-1),1),i=new Date(o.getFullYear(),o.getMonth()+1,0);l.startDate=t.toISOString().split("T")[0],l.endDate=i.toISOString().split("T")[0]},c=async()=>{const s=await(await fetch("/api/approvalList",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...l,page:d.value,pageSize:10})})).json();s.success&&(m.value=s.rows,g.value=s.totalPages)},D=async o=>{const t=await(await fetch(`/api/approval/detail/${o.id}`,{credentials:"include"})).json();p.value={id:t.id,documentType:t.document_type,deptName:t.dept_name,author:t.author,date:t.request_date,totalAmount:t.total_amount,comment:t.comment,aliasName:t.aliasName,items:t.items||[],attachedFiles:t.attachedFiles||[],approvalHistory:t.approvalHistory||[]}},k=o=>new Date(o).toLocaleDateString("ko-KR");return L(()=>{b(),c()}),(o,s)=>(a(),n("div",M,[s[6]||(s[6]=e("h2",{class:"text-2xl font-bold text-purple-700 mb-6"},"📑 내 결재목록 조회",-1)),e("div",O,[e("div",$,[s[3]||(s[3]=e("label",{class:"font-semibold text-gray-800 mb-1"},"청구기간",-1)),e("div",A,[(a(),n(h,null,_([1,3,6,12],t=>e("label",{key:t,class:"flex items-center space-x-1"},[P(e("input",{type:"radio",name:"months",value:t,"onUpdate:modelValue":s[0]||(s[0]=i=>l.months=i),onChange:b},null,40,B),[[R,l.months]]),e("span",V,r(t)+"개월",1)])),64))])]),e("div",z,[e("button",{onClick:s[1]||(s[1]=t=>{d.value=1,c()}),class:"px-6 py-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-lg shadow hover:from-purple-600 hover:to-indigo-700 transition"}," 조회 ")])]),e("div",E,[e("table",H,[s[5]||(s[5]=e("thead",null,[e("tr",{class:"bg-purple-100 text-gray-700"},[e("th",{class:"border p-3"},"부서"),e("th",{class:"border p-3"},"문서종류"),e("th",{class:"border p-3"},"작성자"),e("th",{class:"border p-3"},"요청일"),e("th",{class:"border p-3"},"금액"),e("th",{class:"border p-3"},"상세")])],-1)),e("tbody",null,[(a(!0),n(h,null,_(m.value,t=>(a(),n("tr",{key:t.id,class:"hover:bg-purple-50 transition"},[e("td",U,r(t.dept_name),1),e("td",q,r(t.document_type),1),e("td",Y,r(t.author),1),e("td",G,r(k(t.request_date)),1),e("td",J,r(Math.floor(t.total_amount).toLocaleString()),1),e("td",K,[e("button",{onClick:i=>D(t),class:"px-3 py-1 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition"}," 보기 ",8,Q)])]))),128)),m.value.length===0?(a(),n("tr",W,[...s[4]||(s[4]=[e("td",{colspan:"6",class:"text-center p-6 text-gray-500"},"데이터가 없습니다.",-1)])])):y("",!0)])])]),e("div",X,[(a(!0),n(h,null,_(g.value,t=>(a(),n("button",{key:t,onClick:i=>{d.value=t,c()},class:F(["px-4 py-1 rounded-lg transition",d.value===t?"bg-purple-600 text-white":"bg-white border hover:bg-gray-100"])},r(t),11,Z))),128))]),p.value?(a(),N(T(w),{key:0,report:p.value,onClose:s[2]||(s[2]=t=>p.value=null),onRefreshList:c},null,8,["report"])):y("",!0)]))}};export{nt as default};
