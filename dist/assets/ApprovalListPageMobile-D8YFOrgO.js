const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReportPreview-DfF5__ip.js","assets/pdf-BllNUW5F.js","assets/index-C6LadfhI.js","assets/vue-CbfYRXie.js","assets/network-QpDy7ETe.js","assets/index-DK5L7Jtf.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/ModalAlert-DBpkgysQ.js","assets/ReportPreview-thBETWz2.css"])))=>i.map(i=>d[i]);
import{_ as w}from"./pdf-BllNUW5F.js";import{r as u,G as S,o as C,a as n,b as s,k as L,e as j,s as N,E as P,F as _,f as v,t as r,n as M,z as F,j as o}from"./vue-CbfYRXie.js";import{u as I}from"./index-C6LadfhI.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./network-QpDy7ETe.js";const T={class:"p-4 font-nanum bg-gray-50 min-h-screen"},A={class:"flex justify-center mb-4 space-x-2"},O=["value"],$={key:0,class:"space-y-3"},B={class:"flex justify-between items-center mb-1"},E={class:"font-semibold"},V={class:"text-xs text-gray-500"},z={class:"text-sm text-gray-600"},U={class:"text-sm text-gray-600"},q={class:"text-sm text-gray-600"},H={class:"flex justify-end mt-2"},Y=["onClick"],G={key:1,class:"text-center text-gray-500 py-5"},J={class:"mt-4 flex justify-center space-x-2"},K=["onClick"],Q={__name:"ApprovalListPageMobile",setup(W){var x,f;const b=defineAsyncComponent(()=>w(()=>import("./ReportPreview-DfF5__ip.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),p=u([]),i=u(1),h=u(1),c=u(null),g=I(),l=S({months:1,deptName:((x=g.user)==null?void 0:x.deptName)||"",status:"진행중",approverUserId:((f=g.user)==null?void 0:f.userId)||"",startDate:"",endDate:""}),y=()=>{const a=new Date,e=l.months,t=new Date(a.getFullYear(),a.getMonth()-(e-1),1),m=new Date(a.getFullYear(),a.getMonth()+1,0);l.startDate=t.toISOString().split("T")[0],l.endDate=m.toISOString().split("T")[0]},d=async()=>{const e=await(await fetch("/api/approvalList",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...l,page:i.value,pageSize:10})})).json();e.success&&(p.value=e.rows,h.value=e.totalPages)},k=async a=>{const t=await(await fetch(`/api/approval/detail/${a.id}`,{credentials:"include"})).json();c.value={id:t.id,documentType:t.document_type,deptName:t.dept_name,author:t.author,date:t.request_date,totalAmount:t.total_amount,comment:t.comment,aliasName:t.aliasName,items:t.items||[],attachedFiles:t.attachedFiles||[],approvalHistory:t.approvalHistory||[]}},D=a=>new Date(a).toLocaleDateString("ko-KR");return C(()=>{y(),d()}),(a,e)=>(o(),n("div",T,[e[3]||(e[3]=s("h2",{class:"text-lg font-bold text-gray-800 mb-4"},"✅ 내결재목록 조회",-1)),s("div",A,[N(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.months=t),onChange:y,class:"border rounded px-2 py-1 text-sm"},[(o(),n(_,null,v([1,3,6,12],t=>s("option",{key:t,value:t},r(t)+"개월 ",9,O)),64))],544),[[P,l.months]]),s("button",{onClick:e[1]||(e[1]=t=>{i.value=1,d()}),class:"px-3 py-1 bg-blue-600 text-white rounded text-sm"},"조회")]),p.value.length>0?(o(),n("div",$,[(o(!0),n(_,null,v(p.value,t=>(o(),n("div",{key:t.id,class:"border rounded-lg shadow p-3 bg-white"},[s("div",B,[s("span",E,r(t.document_type),1),s("span",V,r(D(t.request_date)),1)]),s("div",z,"부서: "+r(t.dept_name),1),s("div",U,"작성자: "+r(t.author),1),s("div",q,"금액: "+r(Math.floor(t.total_amount).toLocaleString())+"원",1),s("div",H,[s("button",{onClick:m=>k(t),class:"px-3 py-1 bg-purple-600 text-white rounded text-sm"},"보기",8,Y)])]))),128))])):(o(),n("div",G," 표시할 결재 내역이 없습니다. ")),s("div",J,[(o(!0),n(_,null,v(h.value,t=>(o(),n("button",{key:t,onClick:m=>{i.value=t,d()},class:M(["px-3 py-1 rounded text-sm",i.value===t?"bg-purple-600 text-white":"bg-gray-200"])},r(t),11,K))),128))]),c.value?(o(),L(F(b),{key:2,report:c.value,onClose:e[2]||(e[2]=t=>c.value=null),onRefreshList:d},null,8,["report"])):j("",!0)]))}},at=R(Q,[["__scopeId","data-v-b609164d"]]);export{at as default};
