const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-DY5yBi9I.js","assets/vue-CbfYRXie.js","assets/network-QpDy7ETe.js","assets/pdf-BllNUW5F.js","assets/ReportForm-gMPUKzuA.js","assets/ModalAlert-DBpkgysQ.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/ReportForm-lEIS8UcM.css","assets/ApprovalListMobile-Dq4oEiy4.js","assets/report-R8wnBXMV.js","assets/ApprovalList-BCtH4pG5.js","assets/ApprovalListPageMobile-CjBXFMu_.js","assets/ApprovalListPageMobile-ChhuUvE4.css","assets/ApprovalListPage-BFVmWaE6.js","assets/UserManagement-VejNVIa-.js","assets/UserManagement-DgyCFayA.css","assets/RoleAccess-Bp5E_qCn.js","assets/AccountCategoriesGrid-CxZEgTJl.js","assets/BudgetsGrid-YufPAG88.js","assets/BudgetStatus-DzGMykC4.js"])))=>i.map(i=>d[i]);
import{d as I,o as C,c as A,r as V,a as f,b as i,e as h,F as k,f as D,g,t as p,n as M,h as T,i as E,u as F,j as m,k as B,w as U,l as z,m as j,p as q,q as G}from"./vue-CbfYRXie.js";import{a as d}from"./network-QpDy7ETe.js";import{_ as n}from"./pdf-BllNUW5F.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();const x=I("user",{state:()=>({user:null,access:[]}),getters:{isLoggedIn:r=>!!r.user,roles:r=>{var a,o;return((o=(a=r.user)==null?void 0:a.roles)==null?void 0:o.map(e=>e.role_name))||[]}},actions:{async loadSession(){try{const r=await d.get("/api/session",{withCredentials:!0});if(this.user=r.data.user,this.user&&this.user.roles){let a=[];for(const o of this.user.roles){const e=await d.get(`/api/access/${o.id}`,{withCredentials:!0});a=a.concat(e.data.access)}this.access=a}}catch{this.user=null,this.access=[]}},setUser(r){this.user=r,sessionStorage.setItem("user",JSON.stringify(r))},clearUser(){this.user=null,this.access=[],sessionStorage.removeItem("user")}}}),H={class:"flex h-screen font-nanum"},J={class:"flex-1 space-y-4"},K={class:"mt-auto text-sm text-gray-300"},W={key:0},$={class:"flex-1 bg-gray-100 p-6 overflow-y-auto lg:ml-64"},Q={__name:"App",setup(r){const a=F(),o=x();C(()=>{o.loadSession()});const e=A(()=>o.user),t=[{label:"보고서 작성",path:"/reportForm",icon:"📝"},{label:"청구목록 조회",path:"/approvalList",icon:"📑"},{label:"내결재목록 조회",path:"/approvalStatus",icon:"✅"},{label:"계정과목 관리",path:"/accountCategories",icon:"📊"},{label:"예산 관리",path:"/budgets",icon:"💰"},{label:"예산집행 현황",path:"/budgetStatus",icon:"🏛"},{label:"사용자 관리",path:"/userManagement",icon:"👤"},{label:"권한 관리",path:"/roleAccess",icon:"🔑"}],s=A(()=>e.value?t.filter(c=>o.access.some(_=>_.menu_name===c.label&&_.access_type==="all")):[]),l=V(!1),S=()=>{l.value=!l.value},b=()=>{l.value=!1},w=async()=>{await d.post("/api/logout",{},{withCredentials:!0}),o.clearUser(),a.push("/login")};return(O,c)=>{var y;const _=E("router-link"),R=E("router-view");return m(),f("div",H,[i("aside",{class:M(["bg-gray-800 text-white flex flex-col p-6 fixed top-0 left-0 h-full z-40 transform transition-transform duration-300",l.value?"translate-x-0":"-translate-x-full","w-64 lg:translate-x-0"])},[c[2]||(c[2]=i("h2",{class:"text-2xl font-bold mb-8"},"📑 메뉴",-1)),i("nav",J,[e.value?(m(!0),f(k,{key:0},D(s.value,u=>(m(),B(_,{key:u.path,to:u.path,class:"block hover:bg-gray-700 px-3 py-2 rounded",onClick:b},{default:U(()=>[g(p(u.icon)+" "+p(u.label),1)]),_:2},1032,["to"]))),128)):h("",!0)]),i("div",K,[e.value?(m(),f("div",W,[g(" 👤 "+p(e.value.userName)+" ("+p(e.value.userId)+")",1),c[0]||(c[0]=i("br",null,null,-1)),g(" 권한: "+p(e.value.roles.map(u=>u.role_name).join(", ")),1),c[1]||(c[1]=i("br",null,null,-1)),g(" 부서: "+p((y=e.value)==null?void 0:y.deptName)+" ",1),i("button",{onClick:w,class:"block mt-2 text-red-400 hover:underline"}," 로그아웃 ")])):h("",!0)])],2),l.value?(m(),f("div",{key:0,class:"fixed inset-0 bg-black/50 z-30 lg:hidden",onClick:b})):h("",!0),i("main",$,[i("button",{class:"lg:hidden mb-4 px-3 py-2 bg-purple-600 text-white rounded",onClick:S}," ☰ 메뉴 "),T(R)])])}}};function N(){return/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)}const X=()=>n(()=>import("./Login-DY5yBi9I.js"),__vite__mapDeps([0,1,2,3])),L=()=>n(()=>import("./ReportForm-gMPUKzuA.js"),__vite__mapDeps([4,3,1,2,5,6,7])),Y=()=>N()?n(()=>import("./ApprovalListMobile-Dq4oEiy4.js"),__vite__mapDeps([8,3,1,9,2])):n(()=>import("./ApprovalList-BCtH4pG5.js"),__vite__mapDeps([10,3,1,9,2])),Z=()=>N()?n(()=>import("./ApprovalListPageMobile-CjBXFMu_.js"),__vite__mapDeps([11,3,1,6,2,12])):n(()=>import("./ApprovalListPage-BFVmWaE6.js"),__vite__mapDeps([13,3,1,2])),ee=()=>n(()=>import("./UserManagement-VejNVIa-.js"),__vite__mapDeps([14,2,1,6,15])),te=()=>n(()=>import("./RoleAccess-Bp5E_qCn.js"),__vite__mapDeps([16,1,2])),se=()=>n(()=>import("./AccountCategoriesGrid-CxZEgTJl.js"),__vite__mapDeps([17,1,2])),oe=()=>n(()=>import("./BudgetsGrid-YufPAG88.js"),__vite__mapDeps([18,1,2])),re=()=>n(()=>import("./BudgetStatus-DzGMykC4.js"),__vite__mapDeps([19,1,2])),ae=[{path:"/",redirect:"/login"},{path:"/login",component:X},{path:"/reportForm",component:L,meta:{menuName:"보고서 작성"}},{path:"/report/:id?",name:"ReportForm",component:L,props:!0,meta:{menuName:"보고서 작성"}},{path:"/approvalList",component:Y,meta:{menuName:"청구목록 조회"}},{path:"/approvalStatus",component:Z,meta:{menuName:"내결재목록 조회"}},{path:"/userManagement",component:ee,meta:{menuName:"사용자 관리"}},{path:"/roleAccess",component:te,meta:{menuName:"권한 관리"}},{path:"/accountCategories",component:se,meta:{menuName:"계정과목 관리"}},{path:"/budgets",component:oe,meta:{menuName:"예산 관리"}},{path:"/budgetStatus",component:re,meta:{menuName:"예산집행 현황"}}],P=z({history:j(),routes:ae});P.beforeEach(async(r,a,o)=>{const e=x();if(e.user||await e.loadSession(),!e.user&&r.path!=="/login")return alert("로그인이 필요합니다."),o("/login");if(r.meta.menuName&&!e.access.some(s=>s.menu_name===r.meta.menuName&&s.access_type==="all"))return alert("해당 메뉴에 대한 권한이 없습니다."),o("/login");o()});d.defaults.baseURL="";d.defaults.withCredentials=!0;const v=q(Q);v.use(G());v.provide("session",{user:null,access:[]});v.use(P).mount("#app");export{x as u};
